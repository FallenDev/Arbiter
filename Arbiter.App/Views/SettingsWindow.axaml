<controls:TalgoniteWindow xmlns="https://github.com/avaloniaui"
                          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                          xmlns:controls="using:Arbiter.App.Controls"
                          xmlns:vm="using:Arbiter.App.ViewModels"
                          mc:Ignorable="d"
                          x:Class="Arbiter.App.Views.SettingsWindow"
                          x:DataType="vm:SettingsViewModel"
                          Title="Settings"
                          Width="640" Height="480"
                          CanResize="False"
                          WindowStartupLocation="CenterOwner"
                          ShowInTaskbar="False">
    <controls:TalgoniteWindow.TitleBarContent>
        <DockPanel>
            <Button Command="{Binding HandleResetDefaultsCommand}"
                    Classes="control-box"
                    ToolTip.Tip="Reset to default values.">
                <Path Width="24"
                      Height="16"
                      Stroke="{Binding $parent[Button].Foreground}"
                      Data="{StaticResource Talgonite.Icon.RefreshArrows}"/>
            </Button>
        </DockPanel>
    </controls:TalgoniteWindow.TitleBarContent>
    
    <Grid RowDefinitions="*,Auto" Margin="1,0">
        <TabControl Grid.Row="0" TabStripPlacement="Left" Padding="8" SelectedIndex="7">
            <!-- Game Client Settings Tab -->
            <TabItem Header="Game Client">
                <StackPanel Spacing="4">
                    <Label Content="Game Client Path"
                           ToolTip.Tip="Path to the game executable."/>
                    <TextBox Name="ClientPathTextBox"
                             Text="{Binding ClientExecutablePath}"
                             FontFamily="{StaticResource Talgonite.Font.Monospace}"
                             Watermark="Path to game client..."
                             FontSize="14"
                             Height="50">
                        <TextBox.InnerRightContent>
                            <Button Command="{Binding LocateClientCommand}"
                                    Classes="toolbar outline"
                                    ToolTip.Tip="Opens a file dialog to select the client executable."
                                    Margin="4,2"
                                    Cursor="Hand">
                                <Path Width="16" Height="16"
                                      Stroke="{Binding $parent[Button].Foreground}"
                                      Data="{StaticResource Talgonite.Icon.LoadFolder}"/>
                            </Button>
                        </TextBox.InnerRightContent>
                    </TextBox>
                    
                    <!-- Options -->
                    <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto" RowSpacing="4">
                        <!-- Skip Intro Video  -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Content="Skip Intro Video"
                               ToolTip.Tip="Bypasses the intro video when starting the client."/>
                        <ToggleSwitch Grid.Row="0" Grid.Column="1"
                                      IsChecked="{Binding SkipIntroVideo}"/>
                        <!-- Suppress Login Notice -->
                        <Label Grid.Row="1" Grid.Column="0"
                               Content="Suppress Login Notice"
                               ToolTip.Tip="Prevents the login notification from being displayed."/>
                        <ToggleSwitch Grid.Row="1" Grid.Column="1"
                                      IsChecked="{Binding SuppressLoginNotice}"/>
                    </Grid>
                </StackPanel>
            </TabItem>
            
            <!-- Network Settings Tab -->
            <TabItem Header="Network">
                <StackPanel Spacing="4">
                    <!-- Remote Server -->
                    <Label Content="Remote Server Host"
                           ToolTip.Tip="Hostname of the remote game server."/>
                    <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="4">
                        <TextBox Grid.Column="0"
                                   Text="{Binding RemoteServerAddress}"
                                   FontFamily="{StaticResource Talgonite.Font.Monospace}"
                                   Watermark="Enter a hostname..."
                                   Height="40"/>
                        
                        <Label Grid.Column="1"
                               Content="Port"
                               ToolTip.Tip="Port of the remote game server."/>
                        
                        <NumericUpDown Grid.Column="2"
                                       Value="{Binding RemoteServerPort}"
                                       Minimum="1"
                                       Maximum="65535"
                                       Watermark="1-65535"
                                       TextAlignment="Center"
                                       FontFamily="{StaticResource Talgonite.Font.Monospace}"
                                       Width="100"
                                       Height="40"/>
                    </Grid>
                    
                    <Border Classes="divider-h" Margin="4,8"/>
                    
                    <!-- Local Server Port -->
                    <Grid ColumnDefinitions="Auto,Auto" ColumnSpacing="4">
                        <Label Grid.Column="0" Content="Local Port"
                               ToolTip.Tip="Port to listen on for local client connections."/>
                        <NumericUpDown Grid.Column="1"
                                       Value="{Binding LocalPort}"
                                       Minimum="1"
                                       Maximum="65535"
                                       Watermark="1-65535"
                                       TextAlignment="Center"
                                       FontFamily="{StaticResource Talgonite.Font.Monospace}"
                                       Width="100"
                                       Height="40"/>
                    </Grid>
                </StackPanel>
            </TabItem>
            
            <!-- Tracing Settings Tab -->
            <TabItem Header="Tracing">
                <StackPanel Spacing="4">
                    <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto" Margin="8,4">
                        <!-- Start Tracing on Startup -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Content="Start Trace on Startup"
                               ToolTip.Tip="Begins a trace automatically when the application starts up."/>
                        <ToggleSwitch Grid.Row="0" Grid.Column="1"
                                      IsChecked="{Binding TraceOnStartup}"/>
                        
                        <!-- Autosave traces -->
                        <Label Grid.Row="1" Grid.Column="0"
                               Content="Autosave Traces on Quit"
                               ToolTip.Tip="Automatically saves live trace packets when the application exits."/>
                        <ToggleSwitch Grid.Row="1" Grid.Column="1"
                                      IsChecked="{Binding TraceAutosave}"/>
                    </Grid>
                </StackPanel>
            </TabItem>
            
            <!-- Entities Settings Tab -->
            <TabItem Header="Entities">
                <StackPanel Spacing="4">
                    <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="*,Auto" Margin="8,4">
                        <!-- Show Entity ID for Dialogs -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Content="Show Entity ID in Dialogs"
                               ToolTip.Tip="Shows the entity ID within dialogs (in-game)."/>
                        <ToggleSwitch Grid.Row="0" Grid.Column="1"
                                      IsChecked="{Binding DebugShowDialogId}"/>
                        
                        <!-- Show Entity ID for NPCs -->
                        <Label Grid.Row="1" Grid.Column="0"
                               Content="Show Entity ID on NPCs"
                               ToolTip.Tip="Shows the entity ID next to NPC names (in-game)."/>
                        <ToggleSwitch Grid.Row="1" Grid.Column="1"
                                      IsChecked="{Binding DebugShowNpcId}"/>
                        
                        <Border Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Classes="divider-h"/>
                        
                        <!-- Show Entity ID for Monsters -->
                        <Label Grid.Row="3" Grid.Column="0"
                               Content="Show Entity ID on Monsters"
                               ToolTip.Tip="Shows the entity ID over monsters (in-game)."/>
                        <ToggleSwitch Grid.Row="3" Grid.Column="1"
                                      IsChecked="{Binding DebugShowMonsterId}"/>
                        
                        <!-- Show Entity ID for Monster Click -->
                        <Label Grid.Row="4" Grid.Column="0"
                               Content="Show Entity ID on Monster Click"
                               ToolTip.Tip="Shows the entity ID in the bar message when clicking monsters (in-game)."/>
                        <ToggleSwitch Grid.Row="4" Grid.Column="1"
                                      IsChecked="{Binding DebugShowMonsterClickId}"/>
                        
                    </Grid>
                </StackPanel>
            </TabItem>
            
            <!-- Players Settings Tab -->
            <TabItem Header="Players">
                <StackPanel Spacing="4">
                    <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto" Margin="8,4">
                        <!-- Show Hidden Players -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Content="Show Hidden Players"
                               ToolTip.Tip="Shows hidden players as translucent (in-game)."/>
                        <ToggleSwitch Grid.Row="0" Grid.Column="1"
                                      IsChecked="{Binding DebugShowHiddenPlayers}"/>
                        <!-- Sticky Player Names -->
                        <Label Grid.Row="1" Grid.Column="0"
                               Content="Always Show Player Names"
                               ToolTip.Tip="Always show player names over their head (in-game)."/>
                        <ToggleSwitch Grid.Row="1" Grid.Column="1"
                                      IsChecked="{Binding DebugShowPlayerNames}"/>
                        
                    </Grid>
                </StackPanel>
            </TabItem>
            
            <!-- Effects Settings Tab -->
            <TabItem Header="Effects">
                <StackPanel Spacing="4">
                    <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="*,Auto" Margin="8,4">
                        <!-- Classic Visual Effects -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Content="Classic Visual Effects"
                               ToolTip.Tip="Replaces visual effects with their classic versions (in-game)."/>
                        <ToggleSwitch Grid.Row="0" Grid.Column="1"
                                      IsChecked="{Binding DebugUseClassicEffects}"/>
                        
                        <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Classes="divider-h"/>
                        
                        <!-- Disable Blind -->
                        <Label Grid.Row="2" Grid.Column="0"
                               Content="Disable Blind"
                               ToolTip.Tip="Prevents the screen turning black when blind (in-game)."/>
                        <ToggleSwitch Grid.Row="2" Grid.Column="1"
                                      IsChecked="{Binding DebugDisableBlind}"/>
                    </Grid>
                </StackPanel>
            </TabItem>
            
            <!-- Map Settings Tab -->
            <TabItem Header="Maps">
                <StackPanel Spacing="4">
                    <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="*,Auto" Margin="8,4">
                        <!-- Force Tab Map -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Content="Force Enable Tab Map"
                               ToolTip.Tip="Enables the tab map even if disallowed normally (in-game)."/>
                        <ToggleSwitch Grid.Row="0" Grid.Column="1"
                                      IsChecked="{Binding DebugEnableTabMap}"/>
                        <!-- Zoomed Out Tab Map -->
                        <Label Grid.Row="1" Grid.Column="0"
                               Content="Zoomed Out Tab Map"
                               ToolTip.Tip="Enables the zoomed out tab map display (in-game)."/>
                        <ToggleSwitch Grid.Row="1" Grid.Column="1"
                                      IsChecked="{Binding DebugEnableZoomedOutMap}"/>
                        
                        <Border Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Classes="divider-h"/>
                        
                        <!-- Disable Weather Effects -->
                        <Label Grid.Row="3" Grid.Column="0"
                               Content="Disable Weather Effects"
                               ToolTip.Tip="Disables weather effects on maps (in-game)."/>
                        <ToggleSwitch Grid.Row="3" Grid.Column="1"
                                      IsChecked="{Binding DebugDisableWeatherEffects}"/>
                        <!-- Disable Darkness -->
                        <Label Grid.Row="4" Grid.Column="0"
                               Content="Disable Darkness"
                               ToolTip.Tip="Disables the darkness/lantern light radius effect (in-game)."/>
                        <ToggleSwitch Grid.Row="4" Grid.Column="1"
                                      IsChecked="{Binding DebugDisableDarkness}"/>
                    </Grid>
                </StackPanel>
            </TabItem>
            
            <!-- Messages Settings Tab -->
            <TabItem Header="Messages">
                <Grid RowDefinitions="Auto,Auto" RowSpacing="4">
                    <Grid Grid.Row="0" RowDefinitions="Auto,*" ColumnDefinitions="*,Auto" Margin="8,0">
                        <!-- Ignore Empty World Messages -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Content="Ignore Empty World Messages"
                               ToolTip.Tip="Prevents empty world messages from scrolling the bar (in-game)."/>
                        <ToggleSwitch Grid.Row="0" Grid.Column="1"
                                      IsChecked="{Binding DebugIgnoreEmptyMessages}"/>
                    </Grid>
                    
                    <!-- Filter Rules -->
                    <Grid Grid.Row="1" ColumnDefinitions="*,Auto,Auto" ColumnSpacing="4" Margin="8,0">
                        <Label Grid.Column="0" Content="World Message Filters"
                               ToolTip.Tip="Filter patterns to match, which will be not displayed (in-game)."/>
                        <TextBox Grid.Column="1"
                                 Text="{Binding MessageFilterCount}"
                                 TextAlignment="Center"
                                 Classes="read-only"
                                 FontFamily="{StaticResource  Talgonite.Font.Monospace}"
                                 FontSize="16"
                                 Height="40"
                                 MinWidth="120"
                                 Margin="8,0"
                                 Padding="16,0"
                                 VerticalAlignment="Center"/>
                        <Button Grid.Column="2"
                                Content="Edit.."
                                FontSize="16"
                                Height="40"
                                Padding="8,4"
                                Classes="outline">
                        </Button>
                    </Grid>
                </Grid>
            </TabItem>
            
            <!-- About Tab -->
            <TabItem Header="About">
                <StackPanel Spacing="4" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                            Margin="32">
                    <TextBlock Text="Arbiter"
                               TextAlignment="Center"
                               FontSize="48"
                               FontWeight="Light"/>
                    <TextBlock Text="Dark Ages Network Analysis Tool"
                               TextAlignment="Center"
                               FontSize="18"/>
                    <TextBlock Text="{Binding VersionString, FallbackValue=v1.x.x}"
                               TextAlignment="Center"
                               Foreground="{StaticResource Talgonite.TextBlock.DimForeground}"
                               FontSize="16"/>
                    <Border Classes="divider-h" Margin="16,8"/>
                    <TextBlock Text="Erik 'SiLo' Rogers - 2025"
                               TextAlignment="Center"
                               FontSize="18"/>
                    <HyperlinkButton Command="{Binding VisitProjectWebsiteCommand}"
                                     FontFamily="{StaticResource Talgonite.Font.Monospace}"
                                     Margin="4"
                                     HorizontalAlignment="Stretch">
                        <TextBlock TextAlignment="Center" Classes="link">
                            View on Github
                        </TextBlock>
                    </HyperlinkButton>
                </StackPanel>
            </TabItem>
        </TabControl>
        
        <!-- Accept/Cancel Button Area -->
        <Border Grid.Row="1"
                BorderBrush="{StaticResource Talgonite.Border.DividerBrush}"
                BorderThickness="0,2,0,0"
                Padding="16,8">
            <UniformGrid Columns="2" ColumnSpacing="8" Margin="0,0,0,0">
                <!-- OK button -->
                <Button Command="{Binding HandleOkCommand}" IsDefault="True">
                    <Button.IsEnabled>
                        <MultiBinding Converter="{x:Static BoolConverters.And}">
                            <Binding Path="HasChanges"/>
                            <Binding Path="#ClientPathTextBox.(DataValidationErrors.HasErrors)"
                                     Converter="{x:Static BoolConverters.Not}"/>
                        </MultiBinding>
                    </Button.IsEnabled>
                    <TextBlock Text="Apply"/>
                </Button>
                <!-- Cancel Button -->
                <Button Command="{Binding HandleCancelCommand}" IsCancel="True">
                    <TextBlock Text="Cancel"/>
                </Button>
            </UniformGrid>
        </Border>
    </Grid>
</controls:TalgoniteWindow>
